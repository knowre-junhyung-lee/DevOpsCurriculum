# Quest 06. 컨테이너

## Introduction
* 이번 퀘스트에서는 컨테이너 기술과 그 활용에 대해 알아보겠습니다.

## Topics
* 컨테이너 기술
* Docker
* docker-compose

## Resources
* [Docker 101 Tutorial](https://www.docker.com/101-tutorial)
* [Docker for beginners](https://docker-curriculum.com/)
* [docker-compose](https://docs.docker.com/compose/)

## Checklist
* 컨테이너는 어떻게 동작하나요? 다른 배포판을 사용할 수 있게 하는 원리가 무엇일까요?

  * 컨테이너는 호스트 OS의 커널을 공유하여 하나의 프로세스로써 동작합니다.
리눅스의 namespace과 cgroup 을 사용하여 각 프로세스가 독립적으로 동작할 수 있도록 합니다.
namespace 는 Linux 내의 자원인 pid, net, ipc, 파일 시스템, hostname 등을 담당하고
cgroup 은 컴퓨터의 리소스인 cpu, 메모리, I/O 등을 담당합니다.
리눅스의 다양한 배포판은 공통의 리눅스 커널을 기반으로 만들어지기 때문에
커널을 공유하는 컨테이너의 특성으로 다른 배포판의 실행도 가능합니다.

* 도커 컨테이너에 호스트의 파일시스템이나 네트워크 포트를 연결하려면 어떻게 해야 할까요?

  * 컨테이너를 실행할 때 파일시스템이나, 네트워크 포트 연결에 대한 옵션을 추가하여 실행합니다.
파일시스템은 도커 볼륨을 생성하거나 호스트의 경로를 직접 연결할 수 있습니다.
네트워크 포트는 도커가 호스트 포트를 바인딩한 후 해당 컨테이너의 포트와 연결합니다.
  
  * ex1 ) docker run -v 호스트경로:컨테이너경로 -it --name 컨테이너명 이미지명
  * ex2 ) docker run -p 호스트포트:컨테이너포트 -it --name 컨테이너명 이미지명
  
* 도커 컨테이너에서 런타임에 환경변수를 주입하려면 어떻게 해야 할까요?

  * 컨테이너를 실행할 때 환경변수에 대한 옵션을 추가하여 실행하거나 도커이미지를 빌드할 때 도커 파일에 환경변수를 명시합니다.
  
  * ex ) docker run -e 환경변수명="환경변수내용" -it --name 컨테이너명 이미지명

* 도커 컨테이너의 stdout 로그를 보려면 어떻게 해야 할까요?

  * 실행된 컨테이너를 docker logs 커맨드를 통해 확인합니다.
  
  * ex ) docker logs 컨테이너명

* 실행중인 도커 컨테이너에 들어가 bash 등의 쉘을 실행하고 로그 등을 보려면 어떻게 해야 할까요?

  * 실행된 컨테이너에 docker exec 커맨드를 통해 쉘을 실행 시킵니다.
이미지에 bash 쉘이 없는 경우도 있기 때문에 sh 로 접속해야하는 경우도 종종 있습니다.

  * ex ) docker exec -it 컨테이너 명 /bin/bash



## Quest
* 도커를 설치하고 그 사용법을 익혀 보세요.
* Quest 05에서 작업한 서버를 컨테이너 기반으로 띄울 수 있게 수정해 보세요. (docker-compose는 사용하지 않습니다)
* 컨테이너를 Docker Hub에 올리고, EC2에서 해당 컨테이너를 띄워서 서비스 해 보세요.
* docker-compose를 사용하여, 빌드와 서버 업/다운을 쉽게 할 수 있도록 고쳐 보세요.

## Advanced
* 도커 외의 컨테이너 기술의 대안은 어떤 것이 있을까요?
  * lxc 기반의 lxd 가 존재합니다. 도커와 마찬가지로 namespace, cgroup 을 이용한 컨테이너 기술입니다.
도커와의 차이점은 시스템 컨테이너라는 점입니다. 도커는 어플리케이션을 컨테이너화하는데에 초점이 맞춰져있다면
lxc/lxd 에서는 리눅스 실행 환경을 가상화하는데 초점이 맞춰져 있습니다.

* 맥이나 윈도우에서도 컨테이너 기술을 사용할 수 있는 원리는 무엇일까요?
  * 맥이나 윈도우는 리눅스 커널을 사용하고 있지 않습니다.
하지만 각 OS 에서는 가상화 기술을 제공하고 있습니다.
해당 가상화 기술을 통해서 리눅스 환경을 제공하고 그 환경을 통해 컨테이너를 구동시키는 것 입니다.
